# 后台监控弹窗提醒功能测试指南

## 功能概述

新的监控功能允许系统在后台持续监控股票，当AI给出高置信度的买入或卖出建议时，会自动弹出提醒，无需打开分析结果弹窗。

## 测试步骤

### 1. 开启监控

1. 打开应用，进入分析页面
2. 输入股票代码（如：000001）进行综合分析
3. 等待分析完成后，点击"查看结果"
4. 在分析结果页面点击"帮我盯盘"
5. 选择监控间隔（建议选择5分钟进行快速测试）
6. 点击"开始"开启监控

### 2. 验证监控指示器

1. 开启监控后，页面顶部应该显示监控指示器
2. 指示器显示：
   - 🎯 正在监控: [股票代码]
   - 间隔: [X]分钟 | 自动检测高置信度建议
   - "查看"按钮

### 3. 测试后台监控

1. 关闭分析结果弹窗
2. 监控指示器应该仍然显示在页面顶部
3. 系统在后台继续监控，无需打开弹窗

### 4. 测试弹窗提醒

1. 等待AI生成新的监控记录（根据设置的间隔时间）
2. 当AI给出高置信度的买入或卖出建议时，应该自动弹出提醒
3. 弹窗内容：
   - 🚨 高置信度[买入/卖出]提醒
   - AI建议：[操作] [股票代码]
   - 挂单价格：[价格]
   - 置信度：高
   - 请及时关注交易机会！
   - [知道了] [查看详情]

### 5. 测试查看详情功能

1. 在弹窗中点击"查看详情"
2. 如果当前没有打开分析结果弹窗：
   - 系统会自动打开该股票的分析结果
   - 并自动展开盯盘记录
3. 如果当前已经打开分析结果弹窗：
   - 直接展开盯盘记录

### 6. 测试停止监控

1. 在分析结果页面点击"停止盯盘"
2. 监控指示器应该消失
3. 后台监控应该停止

## 预期行为

### 正常情况

- ✅ 开启监控后显示监控指示器
- ✅ 关闭弹窗后监控指示器仍然显示
- ✅ 后台持续监控，每分钟检查新记录
- ✅ 高置信度建议自动弹出提醒
- ✅ 点击"查看详情"正确打开分析结果
- ✅ 停止监控后指示器消失

### 异常情况

- ❌ 监控指示器不显示
- ❌ 关闭弹窗后监控停止
- ❌ 高置信度建议没有弹窗提醒
- ❌ 点击"查看详情"无法打开分析结果
- ❌ 停止监控后指示器仍然显示

## 测试数据

### 高置信度建议示例

```
【当前建议】买入
【挂单价格】买入：15.25，卖出：15.85
【操作理由】MACD金叉，成交量放大，市场情绪转暖，技术面支撑确认
【风险控制】止损：15.00，止盈：16.20
【置信度】高
```

### 中置信度建议示例

```
【当前建议】观望
【挂单价格】买入：15.20，卖出：15.90
【操作理由】市场情绪谨慎，等待更明确信号，建议观望为主
【风险控制】止损：15.00，止盈：16.00
【置信度】中
```

## 注意事项

1. **测试环境**：确保在交易时间内测试（工作日9:30-15:00）
2. **网络连接**：确保网络连接稳定
3. **数据更新**：监控间隔设置较短可以更快看到效果
4. **重复提醒**：系统会避免对同一条记录重复提醒
5. **页面刷新**：刷新页面后监控状态应该保持

## 故障排除

### 监控指示器不显示
- 检查是否成功开启监控
- 检查网络连接
- 查看控制台错误信息

### 没有弹窗提醒
- 检查AI是否生成了高置信度建议
- 检查监控记录是否正常更新
- 确认置信度是否为"高"

### 查看详情无法打开
- 检查是否有该股票的分析历史记录
- 查看控制台错误信息
- 尝试手动分析该股票

## 性能测试

1. **内存使用**：长时间监控不应导致内存泄漏
2. **网络请求**：每分钟的API请求频率合理
3. **电池消耗**：后台监控不应过度消耗电池
4. **响应速度**：弹窗提醒应该及时响应

## 兼容性测试

1. **iOS设备**：测试不同iOS版本
2. **Android设备**：测试不同Android版本
3. **屏幕尺寸**：测试不同屏幕尺寸下的显示效果
4. **网络环境**：测试不同网络环境下的稳定性
